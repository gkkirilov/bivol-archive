!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}({7:function(e,t,n){e.exports=n(8)},8:function(e,t){var n={};document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".give-form-wrap"),t=[],r=[],a=[],i="",o=give_stripe_vars.preferred_locale;Array.prototype.forEach.call(e,(function(e){var u=e.querySelector(".give-form");if(null!==u){var l=u.getAttribute("data-publishable-key"),c=u.getAttribute("data-account"),s=u.getAttribute("data-id");if(null!==l){n[s]=Stripe(l),0!==c.trim().length&&(n[s]=Stripe(l,{stripeAccount:c}));var p=u.querySelector("input[name=give-form-id]").value,d=e.querySelector(".give-btn-modal"),y=document.querySelector("#give-card-"+p),m=null!==d,v=null!==y,f=n[s].elements({locale:o});if(null!==u.querySelector(".give-gateway-option-selected .give-gateway")&&(i=u.querySelector(".give-gateway-option-selected .give-gateway").value),a[s]=!1,Array.prototype.forEach.call(u.querySelectorAll(".give-gateway"),(function(e){e.addEventListener("change",(function(t){e.checked&&(i=e.value)}))})),document.addEventListener("give_gateway_loaded",(function(e){"stripe_google_pay"!==i&&"stripe_apple_pay"!==i&&"stripe_checkout"!==i||h(s,f)})),m&&d.addEventListener("click",_),v&&y.addEventListener("click",_),Give.fn.getParameterByName("form-id")===u.querySelector("input[name=give-form-id]").value&&["stripe_google_pay","stripe_apple_pay","stripe_checkout"].includes(Give.fn.getParameterByName("payment-mode"))&&(m||v))var g=window.setInterval((function(){jQuery.magnificPopup.instance.isOpen&&(document.getElementsByClassName("mfp-wrap")[0].getElementsByClassName("give-form").length&&(h(s,f),window.clearTimeout(g)))}),500);else"stripe_google_pay"!==i&&"stripe_apple_pay"!==i&&"stripe_checkout"!==i||h(s,f)}}function _(){"stripe_google_pay"!==i&&"stripe_apple_pay"!==i&&"stripe_checkout"!==i||(void 0!==t[s]&&(t[s].removeListener("click"),t[s].unmount("#give-stripe-payment-request-button-"+s)),h(s,f))}function h(e,i){var o,l,c=this,s=u.querySelector('input[name="give-form-title"]'),p=Give.fn.unFormatCurrency(u.querySelector(".give-final-total-amount").dataset.total,u.dataset.decimal_separator);void 0===r[e]&&(r[e]=n[e].paymentRequest({country:give_stripe_vars.base_country,currency:u.getAttribute("data-currency_code").toLowerCase(),total:{label:s.value,amount:Math.round(100*p)},requestShipping:!1,requestPayerName:!0}),r[e].on("paymentmethod",(o=regeneratorRuntime.mark((function e(t){var n,r,a,i,o,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.paymentMethod.billing_details,u.querySelector('input[name="give_stripe_payment_method"]').value=t.paymentMethod.id,(r=document.createElement("input")).setAttribute("type","hidden"),r.setAttribute("name","billing_country"),u.appendChild(r).value=n.address.country,(a=document.createElement("input")).setAttribute("type","hidden"),a.setAttribute("name","card_address"),u.appendChild(a).value=n.address.line1,(i=document.createElement("input")).setAttribute("type","hidden"),i.setAttribute("name","card_address_2"),u.appendChild(i).value=n.address.line2,(o=document.createElement("input")).setAttribute("type","hidden"),o.setAttribute("name","card_city"),u.appendChild(o).value=n.address.city,(l=document.createElement("input")).setAttribute("type","hidden"),l.setAttribute("name","card_zip"),u.appendChild(l).value=n.address.postal_code,(s=document.createElement("input")).setAttribute("type","hidden"),s.setAttribute("name","card_state"),u.appendChild(s).value=n.address.state.toUpperCase(),u.submit(),t.complete("success");case 28:case"end":return e.stop()}}),e,c)})),l=function(){var e=o.apply(this,arguments);return new Promise((function(t,n){return function r(a,i){try{var o=e[a](i),u=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(u).then((function(e){r("next",e)}),(function(e){r("throw",e)}));t(u)}("next")}))},function(e){return l.apply(this,arguments)}))),!1===a[e]&&(t[e]=i.create("paymentRequestButton",{paymentRequest:r[e],style:{paymentRequestButton:{type:"donate",theme:give_stripe_vars.payment_request_button_style,height:"48px"}}}),a[e]=!0),r[e].canMakePayment().then((function(n){var r=document.getElementById("give-stripe-payment-request-button-"+e),i=u.querySelector(".give-stripe-checkout-modal-else-part");r&&(n?(t[e].mount("#give-stripe-payment-request-button-"+e),a[e]=!0,r.style.display="block"):null!==i&&(i.style.display="none"),null===i&&(r.style.display="block"))})),t[e].on("click",(function(t){var n=u.querySelector('input[name="give_validate_stripe_payment_fields"]');null!==n&&n.setAttribute("value","0");var a=new XMLHttpRequest,i=new FormData(u),o=u.querySelector("#give-stripe-payment-errors-"+e);p=Give.fn.unFormatCurrency(u.querySelector(".give-final-total-amount").dataset.total,u.dataset.decimal_separator),i.append("action","give_process_donation"),i.append("give_ajax",!0),r[e].update({currency:u.getAttribute("data-currency_code").toLowerCase(),total:{label:s.value,amount:Math.round(100*p)}}),a.onreadystatechange=function(){4===this.readyState&&200===this.status&&"success"!==this.responseText?(t.preventDefault(),o.innerHTML=this.response):o.innerHTML=""},a.open("POST",give_global_vars.ajaxurl,!1),a.send(i)}))}}))}))}});
//# sourceMappingURL=give-stripe-payment-request.js.map